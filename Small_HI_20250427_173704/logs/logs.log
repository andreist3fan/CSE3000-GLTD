2025-04-27 17:37:04,338 [INFO ] Configuration saved to /home/andrei/Documents/visualSCode/aml-andrei/results/Small_HI_20250427_173704/config.yaml
2025-04-27 17:37:04,339 [INFO ] Random seed set as 67048
2025-04-27 17:37:04,339 [INFO ] Retrieving data
2025-04-27 17:38:29,016 [INFO ] Available Edge Features: ['EdgeID', 'from_id', 'to_id', 'Timestamp', 'Amount Sent', 'Sent Currency', 'Amount Received', 'Received Currency', 'Payment Format', 'Is Laundering']
2025-04-27 17:39:16,852 [INFO ] Illicit ratio = 5177 / 5078345 = 0.10%
2025-04-27 17:39:16,852 [INFO ] Number of nodes (holdings doing transcations) = 515088
2025-04-27 17:39:16,852 [INFO ] Number of transactions = 5078345
2025-04-27 17:39:16,852 [INFO ] Edge features being used: ['Timestamp', 'Amount Received', 'Received Currency', 'Payment Format']
2025-04-27 17:39:16,852 [INFO ] Node features being used: ['Feature'] ("Feature" is a placeholder feature of all 1s)
2025-04-27 17:39:16,930 [INFO ] number of days and transactions in the data: 18 days, 5078345 transactions
2025-04-27 17:39:16,994 [INFO ] Calculate split: [[0, 1, 2, 3, 4, 5], [6, 7], [8, 9, 10, 11, 12, 13, 14, 15, 16, 17]]
2025-04-27 17:39:17,000 [INFO ] Total train samples: 63.98% || IR: 0.08% || Train days: [0, 1, 2, 3, 4]
2025-04-27 17:39:17,001 [INFO ] Total val samples: 19.01% || IR: 0.11% || Val days: [6, 7]
2025-04-27 17:39:17,002 [INFO ] Total test samples: 17.01% || IR: 0.19% || Test days: [8, 9, 10, 11, 12]
2025-04-27 17:39:17,153 [INFO ] train data object: GraphData(x=[515088, 1], edge_index=[2, 3248921], edge_attr=[3248921, 4], y=[3248921], readout='edge', loss_fn='ce', num_nodes=515088, timestamps=[3248921])
2025-04-27 17:39:17,153 [INFO ] validation data object: GraphData(x=[515088, 1], edge_index=[2, 4214445], edge_attr=[4214445, 4], y=[4214445], readout='edge', loss_fn='ce', num_nodes=515088, timestamps=[4214445])
2025-04-27 17:39:17,153 [INFO ] test data object: GraphData(x=[515088, 1], edge_index=[2, 5078345], edge_attr=[5078345, 4], y=[5078345], readout='edge', loss_fn='ce', num_nodes=515088, timestamps=[5078345])
2025-04-27 17:39:17,543 [INFO ] Data is saved to: /home/andrei/Documents/visualSCode/aml-andrei/data/Small_HI/data.pt
2025-04-27 17:39:17,544 [INFO ] Retrieved data in 133.21s
2025-04-27 17:39:17,545 [INFO ] Running Training
2025-04-27 17:39:18,150 [INFO ] +--------------------------------+----------------------------------------+---------------------------+----------+
| Layer                          | Input Shape                            | Output Shape              | #Param   |
|--------------------------------+----------------------------------------+---------------------------+----------|
| MPNN                           | [29275, 29275]                         | [184397, 2]               | 28,917   |
| ├─(node_emb)Linear             | [29275, 1]                             | [29275, 20]               | 40       |
| ├─(edge_emb)Linear             | [184397, 4]                            | [184397, 20]              | 100      |
| ├─(gnn)GnnHelper               | [29275, 20], [2, 184397], [184397, 20] | [29275, 20], [184397, 20] | 24,400   |
| │    └─(convs)ModuleList       | --                                     | --                        | 24,320   |
| │    │    └─(0)PNAConv         | [29275, 20], [2, 184397], [184397, 20] | [29275, 20]               | 12,160   |
| │    │    └─(1)PNAConv         | [29275, 20], [2, 184397], [184397, 20] | [29275, 20]               | 12,160   |
| │    └─(emlps)ModuleList       | --                                     | --                        | --       |
| │    └─(batch_norms)ModuleList | --                                     | --                        | 80       |
| │    │    └─(0)BatchNorm       | [29275, 20]                            | [29275, 20]               | 40       |
| │    │    └─(1)BatchNorm       | [29275, 20]                            | [29275, 20]               | 40       |
| ├─(mlp)Sequential              | [184397, 60]                           | [184397, 2]               | 4,377    |
| │    └─(0)Linear               | [184397, 60]                           | [184397, 50]              | 3,050    |
| │    └─(1)ReLU                 | [184397, 50]                           | [184397, 50]              | --       |
| │    └─(2)Dropout              | [184397, 50]                           | [184397, 50]              | --       |
| │    └─(3)Linear               | [184397, 50]                           | [184397, 25]              | 1,275    |
| │    └─(4)ReLU                 | [184397, 25]                           | [184397, 25]              | --       |
| │    └─(5)Dropout              | [184397, 25]                           | [184397, 25]              | --       |
| │    └─(6)Linear               | [184397, 25]                           | [184397, 2]               | 52       |
+--------------------------------+----------------------------------------+---------------------------+----------+
2025-04-27 17:39:18,150 [INFO ] ****** EPOCH 0 ******
2025-04-27 17:44:56,573 [INFO ] {'Train': {'F1': '0.0019', 'Precision': '0.0011', 'Recall': '0.0067', 'PR-AUC': '0.0019'}}
2025-04-27 17:46:20,216 [INFO ] {'Val': {'F1': '0.0000', 'Precision': '0.0000', 'Recall': '0.0000', 'PR-AUC': '0.0593'}}
2025-04-27 17:46:20,216 [INFO ] {'Test': {'F1': '0.0000', 'Precision': '0.0000', 'Recall': '0.0000', 'PR-AUC': '0.1131'}}
2025-04-27 17:46:20,216 [INFO ] Loss: 0.056436542630004714
2025-04-27 17:46:20,216 [INFO ] {'best_test_f1': '0.0000'}
2025-04-27 17:46:20,219 [INFO ] ****** EPOCH 1 ******
2025-04-27 17:51:15,334 [INFO ] {'Train': {'F1': '0.0000', 'Precision': '0.0000', 'Recall': '0.0000', 'PR-AUC': '0.0509'}}
2025-04-27 17:52:08,402 [INFO ] {'Val': {'F1': '0.0000', 'Precision': '0.0000', 'Recall': '0.0000', 'PR-AUC': '0.1291'}}
2025-04-27 17:52:08,402 [INFO ] {'Test': {'F1': '0.0012', 'Precision': '1.0000', 'Recall': '0.0006', 'PR-AUC': '0.2014'}}
2025-04-27 17:52:08,402 [INFO ] Loss: 0.023674037957114685
2025-04-27 17:52:08,402 [INFO ] ****** EPOCH 2 ******
2025-04-27 17:56:28,679 [INFO ] {'Train': {'F1': '0.1324', 'Precision': '0.2811', 'Recall': '0.0866', 'PR-AUC': '0.1022'}}
2025-04-27 17:57:21,127 [INFO ] {'Val': {'F1': '0.2796', 'Precision': '0.3524', 'Recall': '0.2317', 'PR-AUC': '0.1810'}}
2025-04-27 17:57:21,127 [INFO ] {'Test': {'F1': '0.3469', 'Precision': '0.4025', 'Recall': '0.3048', 'PR-AUC': '0.2574'}}
2025-04-27 17:57:21,127 [INFO ] Loss: 0.02032976194716509
2025-04-27 17:57:21,132 [INFO ] {'best_test_f1': '0.3469'}
2025-04-27 17:57:21,132 [INFO ] ****** EPOCH 3 ******
2025-04-27 18:01:41,540 [INFO ] {'Train': {'F1': '0.2906', 'Precision': '0.3130', 'Recall': '0.2711', 'PR-AUC': '0.1611'}}
2025-04-27 18:02:34,726 [INFO ] {'Val': {'F1': '0.3834', 'Precision': '0.4151', 'Recall': '0.3562', 'PR-AUC': '0.2628'}}
2025-04-27 18:02:34,726 [INFO ] {'Test': {'F1': '0.4623', 'Precision': '0.4429', 'Recall': '0.4836', 'PR-AUC': '0.3451'}}
2025-04-27 18:02:34,726 [INFO ] Loss: 0.018322982830674735
2025-04-27 18:02:34,731 [INFO ] {'best_test_f1': '0.4623'}
2025-04-27 18:02:34,731 [INFO ] ****** EPOCH 4 ******
2025-04-27 18:06:55,446 [INFO ] {'Train': {'F1': '0.3493', 'Precision': '0.3597', 'Recall': '0.3395', 'PR-AUC': '0.2396'}}
2025-04-27 18:07:48,628 [INFO ] {'Val': {'F1': '0.4358', 'Precision': '0.4886', 'Recall': '0.3932', 'PR-AUC': '0.3378'}}
2025-04-27 18:07:48,630 [INFO ] {'Test': {'F1': '0.5215', 'Precision': '0.4923', 'Recall': '0.5543', 'PR-AUC': '0.4120'}}
2025-04-27 18:07:48,630 [INFO ] Loss: 0.01710048009815021
2025-04-27 18:07:48,635 [INFO ] {'best_test_f1': '0.5215'}
2025-04-27 18:07:48,635 [INFO ] ****** EPOCH 5 ******
2025-04-27 18:12:10,491 [INFO ] {'Train': {'F1': '0.3803', 'Precision': '0.3925', 'Recall': '0.3688', 'PR-AUC': '0.2696'}}
2025-04-27 18:13:03,296 [INFO ] {'Val': {'F1': '0.4433', 'Precision': '0.4339', 'Recall': '0.4531', 'PR-AUC': '0.3740'}}
2025-04-27 18:13:03,296 [INFO ] {'Test': {'F1': '0.5262', 'Precision': '0.4658', 'Recall': '0.6046', 'PR-AUC': '0.4715'}}
2025-04-27 18:13:03,296 [INFO ] Loss: 0.0164712508776055
2025-04-27 18:13:03,301 [INFO ] {'best_test_f1': '0.5262'}
2025-04-27 18:13:03,301 [INFO ] ****** EPOCH 6 ******
2025-04-27 18:17:21,184 [INFO ] {'Train': {'F1': '0.4058', 'Precision': '0.4224', 'Recall': '0.3905', 'PR-AUC': '0.3001'}}
2025-04-27 18:18:13,530 [INFO ] {'Val': {'F1': '0.4486', 'Precision': '0.4504', 'Recall': '0.4469', 'PR-AUC': '0.3869'}}
2025-04-27 18:18:13,530 [INFO ] {'Test': {'F1': '0.5400', 'Precision': '0.4916', 'Recall': '0.5990', 'PR-AUC': '0.4708'}}
2025-04-27 18:18:13,530 [INFO ] Loss: 0.015788596156943526
2025-04-27 18:18:13,535 [INFO ] {'best_test_f1': '0.5400'}
2025-04-27 18:18:13,535 [INFO ] ****** EPOCH 7 ******
2025-04-27 18:22:30,483 [INFO ] {'Train': {'F1': '0.4117', 'Precision': '0.4358', 'Recall': '0.3901', 'PR-AUC': '0.3306'}}
2025-04-27 18:23:23,266 [INFO ] {'Val': {'F1': '0.4276', 'Precision': '0.3863', 'Recall': '0.4788', 'PR-AUC': '0.3835'}}
2025-04-27 18:23:23,266 [INFO ] {'Test': {'F1': '0.5087', 'Precision': '0.4158', 'Recall': '0.6549', 'PR-AUC': '0.4980'}}
2025-04-27 18:23:23,266 [INFO ] Loss: 0.01559794588058984
2025-04-27 18:23:23,266 [INFO ] ****** EPOCH 8 ******
2025-04-27 18:27:41,228 [INFO ] {'Train': {'F1': '0.4277', 'Precision': '0.4615', 'Recall': '0.3984', 'PR-AUC': '0.3450'}}
2025-04-27 18:28:33,722 [INFO ] {'Val': {'F1': '0.4508', 'Precision': '0.3871', 'Recall': '0.5396', 'PR-AUC': '0.4064'}}
2025-04-27 18:28:33,722 [INFO ] {'Test': {'F1': '0.4859', 'Precision': '0.3725', 'Recall': '0.6983', 'PR-AUC': '0.4767'}}
2025-04-27 18:28:33,722 [INFO ] Loss: 0.015346461981943399
2025-04-27 18:28:33,727 [INFO ] {'best_test_f1': '0.4859'}
2025-04-27 18:28:33,727 [INFO ] ****** EPOCH 9 ******
